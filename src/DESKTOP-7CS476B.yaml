device:
  name: frontdoor
  version: "1.1"

platforms:
  - platform: plugins.mqtt
    id: mqtt
    host: home
    port: 1883
    availability:
      topic: oo
      payload_on: on
      payload_off: off
    on_connected:
      - actions:
        - action: print
          values:
            payload: hello
    on_disconnected:
      - actions:
        - action: print
          values:
            payload: bye    
    on_message:
      - actions:
        - action: print    

  - platform: plugins.gpio
    id: gpio
    factory: rpigpio

  - platform: plugins.console
    id: console

actions:
  - id: print
    platform: console
    type: PrintAction

sensors:
  - id: availability
    platform: mqtt
    topic: oo
    on_message:
      - conditions:
          - actual: "{{id(mqtt).is_connected}}"
            comperator: equals
            expected: True
        actions:
        - action: print
          values:
            payload: "I got a message and {{id(mqtt).is_connected}} == true"      

      - actions:
        - action: print
          values:
            payload: "Got message on topic '{{topic}}', with payload '{{payload}}'"


        
